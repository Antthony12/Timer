# Timer

Timer is a GTA V script that allows you to measure lap and sector times on custom tracks, displaying on-screen telemetry and saving results to text files.

## Context

This script was born due to the lack of functional mods for timing hot laps in GTA V. It is inspired by [Race Timer](https://www.gta5-mods.com/scripts/race-timer), but improved and updated to function correctly.

## Features

- Lap and sector stopwatch with on-screen notifications.
- Support for multiple tracks defined in a `timer.ini` file.
- Track search system: change tracks without leaving the game.
- Best time records categorized by vehicle and sector.
- Real-time telemetry: speed, RPM, gear, brake, fuel, steering, and tire status.
- Results and telemetry logging in configurable files.
- Customization of colors and units (km/h or mph) via the configuration file.
- Lap cancellation using the `N` key.

## Additional Python Scripts

In addition to the main GTA V script, two Python scripts are included to analyze and visualize the recorded telemetry data:

- **grafica.py**: Visualizes graphs for speed, braking, RPM, and gears over time, marking lap changes. It uses a GUI with Tkinter and Matplotlib for easy data exploration. Data can be exported to PNG using the `Export Graphs` button.
- **mapa3D.py**: Generates a 3D visualization of the vehicle's path using the coordinates recorded in the telemetry. This is useful for seeing the track layout or the route driven in-game.

Both scripts read data from the telemetry file generated by the mod (`telemetriagta5.log`) and require the `matplotlib`, `numpy`, and `tkinter` libraries to be installed.

## Requirements

### Enhanced
- [Script Hook V](https://dev-c.com/gtav/scripthookv/)
- [Script Hook V .Net Enhanced](https://www.gta5-mods.com/tools/script-hook-v-net-enhanced)

### Legacy
- [Script Hook V](https://dev-c.com/gtav/scripthookv/)
- [Script Hook V .Net Enhanced](https://www.gta5-mods.com/tools/script-hook-v-net-enhanced) or [ScriptHookVDotNet-Nightly](https://github.com/scripthookvdotnet/scripthookvdotnet-nightly/releases)

## Installation

1. Copy the `Timer.dll` and `timer.ini` files into the `scripts` folder of your GTA V installation.
2. Configure your tracks and preferences in the `timer.ini` file.
3. Ensure you have the requirements mentioned above installed.

## Configuration

The `timer.ini` file allows you to define:
- File paths for results and telemetry.
- Tracks and their checkpoints.
- Display preferences and telemetry colors.
- Speed units and detection tolerance.

### Main options in `timer.ini`:

- **MostrarTelemetria**: Displays vehicle telemetry when starting a lap. Set to `false` to hide.
- **MostrarTiempoTranscurrido**: Displays elapsed time at the bottom center of the screen. Set to `false` to hide.
- **GuardarTelemetria**: If `true`, it saves 4 telemetry logs per second to the corresponding file. It is recommended to keep this `false` to save disk space.
- **UnidadVelocidad**: Choose the speed unit (km/h or mph).
- **CircuitoSeleccionado**: Select the track you will be driving on.
- **Tolerancia**: Defines the size of the detection area for the finish line and sectors (it is a circle, not a line).
- **ColoresTelemetria**: Customize the colors of the telemetry elements.
- **Circuitos**: Add or remove tracks "easily". Example of a track:

```
[Circuitos]
Nurburgring Nordschleife = x1,y1,z1/x2,y2,z2/x3,y3,z3/...
```

Each trio of coordinates is a checkpoint. The first is the start and the last is the finish (they must be the same to start and end at the same spot). A minimum of 3 points is recommended.

## Usage

- The stopwatch starts automatically when passing through the first checkpoint of the selected track.
- Times and telemetry are displayed on-screen based on your configuration.
- Results are saved to the files specified in the `.ini` file.
- You can cancel the current lap by pressing the `N` key. The script will not activate again until you cross the finish line.
- When passing through sectors, the sector time and the delta relative to the best lap with the same car in the same session will be shown.
- Upon finishing a lap, the time and delta are displayed, and the next lap begins automatically.
- The `gta5.log` file contains basic session information.

### Track Search System

A search system that allows you to change tracks dynamically in-game:

#### Search System Controls

- `Ctrl + B`: Activate/Deactivate search mode.
- `Arrow Up / 8 (Numpad)`: Navigate up the list.
- `Arrow Down / 2 (Numpad)`: Navigate down the list.
- `Enter`: Select the highlighted track.
- `Backspace`: Delete characters in the search bar.

#### How to use the search system

1. During gameplay, press `Ctrl + B` to activate search mode.
2. Type the name of the track you are looking for (e.g., "fuji" to find "Fujimi_Kaido").
3. Use the `up arrow` and `down arrow` to navigate the results.
4. Press `Enter` to select the highlighted track.
5. To exit without selecting, press `Ctrl + B` again.

## Tips and Notes

- To stop the stopwatch and/or cancel the lap, press the `N` key.
- Use `Ctrl + B` to search and change tracks quickly without exiting the game.
- If you find a bug, have an idea, or want to help, leave a comment on the [mod page](https://www.gta5-mods.com/scripts/laps-timer).
- This is a basic script.
- I personally enjoy using it as a complement to the [Ghost Replay](https://www.gta5-mods.com/scripts/ghost-car) mod to have lap telemetry.

> [!IMPORTANT] 
> To prevent the telemetry file from growing excessively, it is recommended to keep logging disabled or establish a periodic cleanup process. The file size can increase rapidly during long sessions.

## Included Tracks

The `timer.ini` file includes more than 30 popular tracks:

- [NÃ¼rburgring (various configurations)](https://www.gta5-mods.com/maps/nurburgring-nordschleife-circuit-hq) 
- [Circuit de la Sarthe (Le Mans)](https://www.gta5-mods.com/maps/le-mans-circuit-sp-fivem)
- [Spa-Francorchamps](https://www.gta5-mods.com/maps/spa-francorchamps-2025-singleplayer-addon)
- [Monza 1966](https://www.gta5-mods.com/maps/monza-1966-add-on-sp-fivem)
- [Monza (various versions)](https://www.gta5-mods.com/maps/monza-modern-day-add-on-sp-fivem)
- [Barcelona-Catalunya](https://www.gta5-mods.com/maps/circuit-de-barcelona-catalunya-vsr-kevin)
- [Imola](https://www.gta5-mods.com/maps/autodromo-enzo-e-dino-ferrari-imola-circuit)
- [Monaco](https://www.gta5-mods.com/maps/monaco-grand-prix)
- [Laguna Seca](https://www.gta5-mods.com/maps/laguna-seca-add-on-fivem)
- [Mount Panorama](https://www.gta5-mods.com/maps/bathurst-mount-panorama-add-on-fivem)
- [Top Gear Test Track](https://www.gta5-mods.com/maps/top-gear-uk-test-track-add-on-sp-fivem)
- [Fujimi Kaido](https://www.gta5-mods.com/maps/fujimi-kaido-overhaul-add-on-fivem)

###### I believe they are configured to the default mod positions; if not, please let me know.

## License

This project is under the MIT License. See the [LICENSE.txt](LICENSE.txt) file for more details.